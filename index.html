<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>URL Shortener</title>
        <!-- Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- Bootstrap CSS -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet">
        <style>
        body {
            background: linear-gradient(to bottom right, #4CAF50, #3a7bd5);
        }
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 255, 255, 0.1);
            font-size: 4rem;
            font-weight: bold;
            pointer-events: none;
            animation: move 5s linear infinite alternate;
        }
        @keyframes move {
            from {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            to {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }
    </style>
    </head>
    <body>
        <div class="watermark">Santeck & Webleex</div>
        <div
            class="container d-flex justify-content-center align-items-center min-vh-100">
            <div class="card shadow-lg p-4 rounded-lg bg-white w-100"
                style="max-width: 400px;">
                <h2 class="text-center text-xl font-bold text-gray-800">URL
                    Shortener</h2>
                <form id="urlForm" class="mt-4">
                    <input type="text" id="longUrl"
                        placeholder="Enter your URL here"
                        class="form-control mb-3" required>
                    <button type="submit" class="btn btn-primary w-100">Shorten
                        URL</button>
                </form>
                <div id="shortUrl" class="mt-3 text-center"></div>
            </div>
        </div>
        <script>
        // LocalStorage to mimic URL mapping
        const urlDb = JSON.parse(localStorage.getItem('urlDb')) || {};

        // Generate a random short key
        const generateShortKey = () => {
            const characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            return Array(6).fill(0).map(() => characters.charAt(Math.floor(Math.random() * characters.length))).join('');
        };

        // Handle form submission
        document.getElementById('urlForm').addEventListener('submit', (event) => {
            event.preventDefault();

            const longUrl = document.getElementById('longUrl').value.trim();
            if (!longUrl) return alert('Please enter a valid URL.');

            // Generate a unique short key
            let shortKey = generateShortKey();
            while (urlDb[shortKey]) shortKey = generateShortKey();

            // Save mapping to "localStorage"
            urlDb[shortKey] = longUrl;
            localStorage.setItem('urlDb', JSON.stringify(urlDb));

            // Display shortened URL
            const shortUrlDiv = document.getElementById('shortUrl');
            const shortUrl = `${window.location.origin}/sc/#/${shortKey}`;
            shortUrlDiv.innerHTML = `
                <div class="alert alert-success">
                    Short URL: <a href="${shortUrl}" target="_blank">${shortUrl}</a>
                </div>`;
        });

        // Redirect logic for short URLs
        const hash = window.location.hash.replace('/#/', '');
        if (hash && urlDb[hash]) {
            window.location.href = urlDb[hash];
        } else if (hash) {
            alert('Invalid short URL!');
        }
    </script>
    </body>
</html>
